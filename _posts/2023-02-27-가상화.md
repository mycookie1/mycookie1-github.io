---
layout: post
title:  "가상화"
category: 서버
tags: [가상화]
---
가상화(Virtualization)란 하나의 물리적인 컴퓨터 또는 서버에서 여러 개의 가상 머신(Virtual Machine)을 생성하여, 각 가상 머신에서는 독립된 운영체제와 응용프로그램이 동작할 수 있도록 하는 기술을 말합니다. 즉, 하나의 서버에서 여러 대의 서버를 구축하고 사용할 수 있게 만들어주는 기술입니다.

가상화 기술을 사용하면 여러 대의 물리적인 서버를 구축하는 것보다 더 적은 물리적 자원을 사용하여 가상 서버를 생성하고 운영할 수 있습니다. 또한, 가상 서버를 생성하여 운영하는 경우, 하드웨어의 종속성이 없기 때문에 하드웨어를 업그레이드하거나 대체할 때도 비교적 쉽게 대처할 수 있습니다. 또한, 여러 대의 서버를 하나의 물리적 서버에서 운영할 수 있기 때문에 관리 및 유지보수 비용을 줄일 수도 있습니다.

### 종류
- 호스트 OS 가상화
- 전가상화(하이퍼바이저)
- 반가상화(하이퍼바이저)
- 컨테이너

### 호스트 OS 가상화
호스트 OS 가상화(Host OS Virtualization)는 컨테이너 기반 가상화 기술 중 하나로, 하이퍼바이저를 사용하지 않고 호스트 OS 위에 독립적인 가상 환경을 만드는 기술입니다.

이 방식은 하이퍼바이저를 사용하는 전가상화와 달리, 호스트 OS를 공유하면서 여러 개의 가상머신을 실행하므로, 가상머신의 생성 및 실행에 소요되는 자원이 적고, 빠른 실행이 가능합니다.


### 하이퍼바이저
하이퍼바이저(Hypervisor)는 가상화 기술을 구현하기 위한 소프트웨어 레이어로, 호스트 시스템(Physical Host) 위에 여러 개의 가상 머신(Virtual Machine)을 생성하고 관리하는 역할을 합니다.

하이퍼바이저는 크게 두 가지로 나뉩니다. 첫 번째는 타입 1 하이퍼바이저로, 하이퍼바이저가 물리적인 서버의 하드웨어와 직접적으로 상호작용합니다. 이 경우, 하이퍼바이저는 가상화된 모든 하드웨어 리소스를 관리하며, 호스트 시스템의 운영체제와 독립적으로 작동합니다. 이러한 하이퍼바이저는 전가상화(Full Virtualization)를 구현하며, 대표적인 제품으로는 VMware ESXi, Citrix XenServer 등이 있습니다.

두 번째는 타입 2 하이퍼바이저로, 반가상화는 가상머신 내부에서 하드웨어에 직접 액세스하는 것이 아니라, 하이퍼바이저와 가상머신 간의 인터페이스를 통해 하드웨어 자원에 액세스합니다. 이를 위해 가상머신은 하이퍼바이저에 대한 수정된 드라이버를 사용합니다.

하이퍼바이저를 이용하면 여러 개의 가상 머신을 한 대의 물리적인 서버에서 생성하여 운영할 수 있기 때문에, 하나의 서버를 최대한 활용하여 비용을 절감할 수 있습니다. 또한, 가상 머신의 생성, 삭제, 이전 등의 작업이 쉽고 빠르기 때문에, 시스템 관리 및 유지보수에 대한 비용도 줄일 수 있습니다.

### 전가상화
장단점: 게스트OS의 별다른 수정없이 사용할 수 있다. 하지만 하이퍼바이저가 모든 명령을 중재하기 때문에 성능이 느리다. 또한 하이퍼바이저가 중재 이외의 문제들도 다 처리해 주어야 한다.

### 반가상화
장단점: 전가상화의 단점인 성능 저하를 해소하고자 모든 명령을 DOM0을 통해 하이퍼바이저에게 요청하지 않고, 하이퍼콜이라는 인터페이스로 직접 하이퍼바이저에 요청을 날린다. 따라서 전가상화에 비해 성능이 빠르다. 하지만 하이퍼콜을 이용하면 하이퍼바이저에게 요청을 보내는 동작을 기존의 OS는 할 수 없으므로 커널 수정 작업이 들어가야 한다

가상화 기술은 클라우드 컴퓨팅, 서버 가상화, 테스트 환경 구성 등에서 사용됩니다.

### 컨테이너
프로세스를 격리 하는 방식.
리눅스에서는 이러한 방식을 리눅스 컨테이너라고 한다. OS를 가상화하는 것이 아닌, 운영체제 수준의 가상화 기술로 리눅스 커널을 공유함과 동시에 프로세스를 격리된 환경에서 실행한다. 때문에 하이퍼바이저 가상화 방식보다 더욱 가볍고 빠르게 동작한다.

컨테이너 가상화를 통해 하나의 서버에서 다수의 컨테이너를 실행하면 컨테이너끼리 서로 영향을 끼치지 않음과 동시에 독립적으로 실행된다. 실행중인 컨테이너에 접속하여 명령어 입력하거나 패키지를 설치하는 등 다양한 작업이 가능하다. 또한 CPU 혹은 메모리를 제한할 수 있으며 호스트 디렉토리에 마운트하여 내부 디렉토리로 사용할 수도 있습니다.

새로운 컨테이너를 만드는 데 들어가는 시간은 OS를 가상화하는 방식엔 비교할 수 없을 정도로 빠르다. 그리고 하나의 프로세스(컨테이너)를 실행하는데 필요한 모든 파일을 이미지로 만들어 제공한다. 때문에 컨테이너 가상화 방식을 사용하면 개발 단계부터 테스트 및 프로덕션에 이르기까지 일관된 환경을 유지할 수 있다.

그러나, 컨테이너는 호스트 OS와 밀접하게 연관되어 있으므로, 호스트 OS의 보안 취약점이나 버전 호환성 문제 등에 노출될 가능성이 있습니다. 따라서, 컨테이너 보안을 강화하기 위해서는 적절한 보안 정책과 함께 관리와 모니터링이 필요합니다.

### 도커와 하이퍼바이저의 차이
도커와 하이퍼바이저는 가상화 기술을 사용하여 컴퓨터 시스템을 분리하고, 리소스를 효율적으로 사용할 수 있도록 도와주는 기술입니다. 하지만, 둘은 전혀 다른 방식으로 가상화를 수행합니다.

하이퍼바이저는 가상머신을 생성하고, 각 가상머신은 자체적인 운영체제(OS)를 가지고 작동합니다. 즉, 각 가상머신은 독립적인 환경에서 동작하기 때문에, 호스트와 다른 운영체제(OS)를 실행할 수 있습니다. 하이퍼바이저의 예로는 VMWare, VirtualBox, Xen 등이 있습니다.

반면, 도커는 호스트 OS 위에 설치되어, 각 컨테이너를 생성하고, 각 컨테이너는 호스트 OS의 리소스를 공유합니다. 컨테이너는 호스트 OS와 동일한 운영체제(OS) 커널을 공유하기 때문에, 더 가볍고 빠르게 실행될 수 있습니다. 또한, 컨테이너는 이미지로부터 생성되기 때문에, 배포 및 관리가 쉽습니다.

즉, 하이퍼바이저는 가상머신 단위로 가상화를 수행하고, 각 가상머신은 독립적인 운영체제를 가지고 작동합니다. 반면, 도커는 컨테이너 단위로 가상화를 수행하고, 각 컨테이너는 호스트 OS와 동일한 운영체제 커널을 공유합니다. 이러한 차이로 인해, 도커는 더 가볍고 빠르게 실행되며, 더 효율적인 리소스 사용이 가능합니다.